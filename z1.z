(const syscall_write 1)
(const stdout 1)
(const newline 0x0A)

(const mem:start 4096)

(fun (write buf len)
  (return (syscall syscall_write stdout buf len)))

(fun (strlen str)
  (var l 0)
again
  (goto done (not (b@ str l)))
  (= l (+ l 1))
  (goto again)
done
  (return l))

(fun (int-to-str buf i)
  (var p buf)
next-digit
  (b@= p (+ (% i 10) 48))
  (= p (+ p 1))
  (= i (/ i 10))
  (goto next-digit i)
  (b@= p 0))

(fun (main)
  (int-to-str mem:start 12)
  (write mem:start (strlen mem:start)))

(data hello (s 'Hello World') (b newline 0))
